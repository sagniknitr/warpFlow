# warpFlow
Optical flow using warping and energy minimization techniques


![](https://github.com/sagniknitr/warpFlow/blob/master/Test/flow-field.png?raw=true)




## Playing with Parameters 



### Original Parameters 


| alpha | pyramid scale | min width | outer iter | inner iter | sor iter | RGB/Gray |
|-------|---------------|-----------|------------|------------|----------|----------|
| 0.011 |      0.75     |     20    |     7      |     1      |    30    |    0     |
|-------|---------------|-----------|------------|------------|----------|----------|

Finished Processing
Time Taken: 7.39 seconds for image of size (480, 640, 3)


|--------------------|------------|----------|----------|----------|---------|---------|----------|
| Middlebury dataset | Average AE |   R1.0   |   R3.0   |   R5.0   |   A50   |   A75   |   A95    |
|--------------------|------------|----------|----------|----------|---------|---------|----------|
|       Urban2       |  2.788123  | 41.16569 | 16.96549 |  9.8418  | 0.63827 | 2.05376 | 10.42582 |
|    RubberWhale     |  4.587802  | 59.93093 | 19.80042 | 12.9125  | 1.23051 | 2.33691 | 18.49122 |
|       Grove3       |  6.124448  | 60.62402 | 29.27897 | 20.40007 | 1.38861 |  3.7717 | 25.84034 |
|     Dimetrodon     | 3.5564358  | 79.54499 | 44.42406 | 23.72903 | 2.60643 | 4.84857 | 9.79722  |
|     Hydrangea      | 2.3159814  | 29.29121 | 17.81146 | 11.78299 | 0.60361 | 1.59563 | 10.48321 |
|       Urban3       |  7.509062  | 31.05208 | 20.24674 | 19.07747 | 0.52039 | 1.41858 | 50.86626 |
|       Venus        | 7.3363495  | 89.0614  | 40.15664 | 18.52005 | 2.43019 | 3.77595 | 13.1407  |
|       Grove2       | 2.3949218  | 47.09538 | 10.45215 | 6.87109  | 0.94398 | 1.58859 |  7.9697  |
|--------------------|------------|----------|----------|----------|---------|---------|----------|

Average AE across dataset  4.576640367507935

|--------------------|------------|----------|----------|---------|---------|---------|---------|
| Middlebury dataset | Average EE |   R0.1   |   R0.5   |   R2.0  |   A50   |   A75   |   A95   |
|--------------------|------------|----------|----------|---------|---------|---------|---------|
|       Urban2       | 0.35632402 | 40.93359 | 9.56836  | 3.71777 |  0.0821 | 0.16598 | 1.21204 |
|    RubberWhale     | 0.13686846 | 19.50262 | 5.04373  | 1.34996 | 0.04286 | 0.07741 | 0.50609 |
|       Grove3       | 0.66983014 | 56.1569  | 23.39518 |  8.6276 | 0.12516 | 0.44404 | 4.22607 |
|     Dimetrodon     | 0.19025294 | 61.90158 |  7.914   | 0.00834 | 0.13091 | 0.24685 |  0.5884 |
|     Hydrangea      | 0.18256375 | 30.79986 | 8.67074  | 1.01695 | 0.05039 | 0.16833 | 0.73727 |
|       Urban3       | 0.8207968  | 54.87793 | 27.7487  | 8.68197 | 0.12286 | 0.77024 | 4.37185 |
|       Venus        | 0.43895015 | 88.01441 | 13.94048 | 4.44048 | 0.21331 | 0.33509 | 1.63476 |
|       Grove2       | 0.1628243  | 27.7487  | 5.36947  | 1.42057 | 0.06622 | 0.10826 | 0.55855 |
|--------------------|------------|----------|----------|---------|---------|---------|---------|

Average EE across dataset 0.38976073682308197


### TEST ANALOG 2 ( Increase inner iterations, increase alpha, increase pyramid scale)



| alpha | pyramid scale | min width | outer iter | inner iter | sor iter | RGB/Gray |
|-------|---------------|-----------|------------|------------|----------|----------|
|  0.1  |      0.9      |     20    |     7      |     7      |    30    |    0     |
|-------|---------------|-----------|------------|------------|----------|----------|

Finished Processing
Time Taken: 116.29 seconds for image of size (480, 640, 3)

|--------------------|------------|----------|----------|----------|---------|----------|-----------|
| Middlebury dataset | Average AE |   R1.0   |   R3.0   |   R5.0   |   A50   |   A75    |    A95    |
|--------------------|------------|----------|----------|----------|---------|----------|-----------|
|       Urban2       | 25.415655  | 72.17904 | 56.33203 | 49.59928 | 4.82735 | 21.00697 | 121.30746 |
|    RubberWhale     |  9.922485  | 83.64982 | 54.14585 | 32.5842  | 3.21138 | 7.26625  |  52.55441 |
|       Grove3       | 10.658092  | 83.87826 | 57.09473 | 43.92285 | 3.94593 | 9.57401  |  75.47273 |
|     Dimetrodon     |  8.285472  | 95.00973 | 71.52813 | 57.78565 | 6.27348 | 11.29189 |  23.98672 |
|     Hydrangea      | 3.4908392  | 64.79604 | 27.75091 | 17.13224 | 1.49056 | 3.36707  |  15.36523 |
|       Urban3       | 23.570948  | 83.62663 | 62.38021 | 45.60612 | 4.12834 | 8.82684  | 131.59241 |
|       Venus        |  10.3737   | 89.16729 | 45.52005 | 24.25627 | 2.72268 |  4.8853  | 118.90795 |
|       Grove2       |  6.261554  | 74.57031 | 44.72135 | 35.65332 | 2.31241 | 8.05277  |  18.25334 |
|--------------------|------------|----------|----------|----------|---------|----------|-----------|

Average AE across dataset  12.247343093156815

|--------------------|------------|----------|----------|----------|---------|---------|---------|
| Middlebury dataset | Average EE |   R0.1   |   R0.5   |   R2.0   |   A50   |   A75   |   A95   |
|--------------------|------------|----------|----------|----------|---------|---------|---------|
|       Urban2       |  1.788162  | 89.51139 | 59.51432 | 28.68229 |  0.7126 | 2.75689 |  7.5882 |
|    RubberWhale     | 0.32519668 | 54.46742 | 13.7745  |  4.1315  | 0.11364 | 0.26513 | 1.84043 |
|       Grove3       | 1.3100804  | 78.48405 | 51.18652 | 21.63021 | 0.53333 | 1.80437 | 5.51592 |
|     Dimetrodon     | 0.4164821  | 87.47243 | 28.91067 |  0.1302  | 0.32094 | 0.54888 | 1.11705 |
|     Hydrangea      | 0.35684592 | 69.31917 | 14.88768 | 2.59315  |  0.1542 | 0.30323 | 1.27689 |
|       Urban3       | 3.7436378  | 88.45117 | 69.78255 | 61.34928 | 2.85663 | 6.22901 | 9.62159 |
|       Venus        | 0.7316697  | 86.73935 | 31.3797  | 8.09085  | 0.25432 | 0.78739 |  4.3833 |
|       Grove2       | 0.39169624 | 63.25716 | 24.59831 |  3.0319  | 0.16767 | 0.49371 | 1.10404 |
|--------------------|------------|----------|----------|----------|---------|---------|---------|


Average EE across dataset  1.1329713575541973


### TEST ANALOG 3 (Reduce pyramid scale |  Reduce min width)

|-------|---------------|-----------|------------|------------|----------|----------|
| alpha | pyramid scale | min width | outer iter | inner iter | sor iter | RGB/Gray |
|-------|---------------|-----------|------------|------------|----------|----------|
|  0.02 |      0.3      |     20    |     7      |     1      |    30    |    0     |
|-------|---------------|-----------|------------|------------|----------|----------|

Finished Processing
Time Taken: 7.07 seconds for image of size (480, 640, 3)

|--------------------|------------|----------|----------|----------|----------|----------|-----------|
| Middlebury dataset | Average AE |   R1.0   |   R3.0   |   R5.0   |   A50    |   A75    |    A95    |
|--------------------|------------|----------|----------|----------|----------|----------|-----------|
|       Urban2       | 17.922949  | 99.86654 | 91.69336 | 77.40332 | 11.61107 | 20.70806 |  59.83025 |
|    RubberWhale     |  13.85937  | 95.75279 | 76.92066 | 65.87209 | 8.71881  | 15.49661 |  50.36643 |
|       Grove3       | 17.279848  | 98.14421 | 91.04818 | 86.4248  | 13.89618 | 19.67545 |  39.75967 |
|     Dimetrodon     | 26.493235  | 99.71828 | 97.97007 | 96.41785 | 25.29531 | 36.20542 |  44.7334  |
|     Hydrangea      | 14.806516  | 99.63819 | 97.21697 | 94.20581 | 14.72799 | 15.38791 |  24.38532 |
|       Urban3       |  27.55642  | 99.97461 | 99.82845 | 94.56608 | 10.75666 | 17.35813 | 156.54589 |
|       Venus        | 19.720602  | 99.97494 | 99.62093 | 98.84336 | 13.47635 | 17.15368 |  40.34777 |
|       Grove2       |  20.1571   | 99.99805 | 99.9834  | 99.95605 | 19.02946 | 22.68728 |  30.53881 |
|--------------------|------------|----------|----------|----------|----------|----------|-----------|

Average AE across dataset  19.724504947662354

|--------------------|------------|----------|----------|----------|-----------|------------|-------------|
| Middlebury dataset | Average EE |   R0.1   |   R0.5   |   R2.0   |    A50    |    A75     |     A95     |
|--------------------|------------|----------|----------|----------|-----------|------------|-------------|
|       Urban2       | 2612.4644  | 99.08561 | 92.31934 | 87.63574 |  69.97058 | 2998.74689 | 11995.84805 |
|    RubberWhale     | 1.2264806  |  80.727  | 41.37014 | 12.12181 |  0.36721  |  0.85364   |   4.15514   |
|       Grove3       |  405.7128  | 91.41016 | 84.74772 | 77.32878 |  27.67462 | 171.92622  |  797.69281  |
|     Dimetrodon     | 28.802628  | 98.98434 | 95.11074 | 88.58076 |  19.37083 |  51.59899  |   74.77629  |
|     Hydrangea      |  398.6386  | 98.42427 | 90.44787 | 85.04808 | 555.97519 |  674.2748  |   719.954   |
|       Urban3       |  2308.847  | 99.98372 | 99.7806  | 99.15007 | 884.44882 | 2103.51703 |  7993.75383 |
|       Venus        | 163.61049  | 99.68672 | 96.63722 | 87.33459 |  18.58005 |  45.09319  |  153.11384  |
|       Grove2       | 108.51198  | 99.99967 | 99.97949 | 99.78548 |  16.87617 | 135.44563  |  480.00854  |
|--------------------|------------|----------|----------|----------|-----------|------------|-------------|

Average EE across dataset  753.4767830520868



### TEST ANALOG 4 ( increase alpha | increase pyramid scale | Reduce min width)

|-------|---------------|-----------|------------|------------|----------|----------|
| alpha | pyramid scale | min width | outer iter | inner iter | sor iter | RGB/Gray |
|-------|---------------|-----------|------------|------------|----------|----------|
|  0.02 |      0.8      |     10    |     7      |     1      |    30    |    0     |
|-------|---------------|-----------|------------|------------|----------|----------|

Finished Processing
Time Taken: 9.88 seconds for image of size (480, 640, 3)

|--------------------|------------|----------|----------|----------|---------|---------|----------|
| Middlebury dataset | Average AE |   R1.0   |   R3.0   |   R5.0   |   A50   |   A75   |   A95    |
|--------------------|------------|----------|----------|----------|---------|---------|----------|
|       Urban2       | 3.3966296  | 46.3099  | 22.77018 | 14.10677 | 0.82115 | 2.68542 | 13.58149 |
|    RubberWhale     | 5.6972513  | 64.69391 | 22.66628 | 16.10306 | 1.34188 | 2.63022 | 29.51442 |
|       Grove3       |  6.534391  | 62.19824 | 29.08333 | 21.34635 | 1.41748 | 3.82724 | 28.19518 |
|     Dimetrodon     |  4.239312  | 79.57835 | 52.94134 | 33.68733 | 3.28375 | 6.17528 | 10.97356 |
|     Hydrangea      | 2.3090353  | 34.38445 | 16.80679 | 10.91294 | 0.72443 | 1.63437 | 9.89828  |
|       Urban3       |  13.31261  | 33.80241 | 21.15951 | 19.58301 | 0.60523 | 1.56047 | 95.30946 |
|       Venus        | 7.7949677  | 89.69236 | 36.6015  | 19.16291 | 2.41865 | 4.01465 | 11.89348 |
|       Grove2       | 2.8202114  | 51.15918 | 16.57194 | 9.74023  | 1.02029 | 1.90721 | 9.63943  |
|--------------------|------------|----------|----------|----------|---------|---------|----------|

Average AE across dataset  5.763051003217697

|--------------------|------------|----------|----------|----------|---------|---------|---------|
| Middlebury dataset | Average EE |   R0.1   |   R0.5   |   R2.0   |   A50   |   A75   |   A95   |
|--------------------|------------|----------|----------|----------|---------|---------|---------|
|       Urban2       | 0.44740972 | 52.33171 | 13.95052 | 5.46484  | 0.10621 | 0.22594 | 2.41877 |
|    RubberWhale     | 0.17579742 | 22.6461  | 8.28318  | 1.67153  | 0.04558 | 0.08756 | 0.93647 |
|       Grove3       | 0.7476732  | 57.49056 | 27.26367 | 10.25618 |  0.1425 | 0.58952 | 4.59474 |
|     Dimetrodon     | 0.22215746 | 65.49254 | 10.5917  |  0.0139  |  0.1591 | 0.30538 | 0.65366 |
|     Hydrangea      | 0.18776187 | 34.90874 | 8.29476  | 1.08544  | 0.06212 | 0.15898 |  0.7348 |
|       Urban3       |  1.130463  | 60.97689 | 30.95866 | 16.25846 | 0.16027 | 1.00559 | 5.58408 |
|       Venus        | 0.4767087  | 86.99123 | 16.8985  | 4.84524  | 0.21473 | 0.33024 |  1.8986 |
|       Grove2       | 0.18370633 | 31.67155 | 6.13281  | 1.70605  | 0.06558 | 0.13166 | 0.62501 |
|--------------------|------------|----------|----------|----------|---------|---------|---------|

Average EE across dataset  0.4464597161859274



### TEST CASE ANALOG 5 (increase alpha | increase pyramid scale | increase min width )



|-------|---------------|-----------|------------|------------|----------|----------|
| alpha | pyramid scale | min width | outer iter | inner iter | sor iter | RGB/Gray |
|-------|---------------|-----------|------------|------------|----------|----------|
|  0.02 |      0.8      |     30    |     7      |     1      |    30    |    0     |
|-------|---------------|-----------|------------|------------|----------|----------|

Finished Processing
Time Taken: 9.56 seconds for image of size (480, 640, 3)

|--------------------|------------|----------|----------|----------|---------|---------|----------|
| Middlebury dataset | Average AE |   R1.0   |   R3.0   |   R5.0   |   A50   |   A75   |   A95    |
|--------------------|------------|----------|----------|----------|---------|---------|----------|
|       Urban2       | 3.3955085  | 46.3112  | 22.74577 | 14.09277 | 0.82115 | 2.68418 | 13.5833  |
|    RubberWhale     | 5.6972513  | 64.69391 | 22.66628 | 16.10306 | 1.34188 | 2.63022 | 29.51442 |
|       Grove3       |  6.53439   | 62.19792 | 29.08333 | 21.34635 | 1.41755 | 3.82728 | 28.19518 |
|     Dimetrodon     | 4.2393126  | 79.57835 | 52.9418  | 33.68687 | 3.28372 | 6.17518 | 10.97356 |
|     Hydrangea      | 2.3090353  | 34.38586 | 16.80679 | 10.91294 | 0.72443 | 1.63437 | 9.89828  |
|       Urban3       | 13.307316  | 33.80176 | 21.15723 | 19.58301 | 0.60523 | 1.56047 | 95.22421 |
|       Venus        |  7.796229  | 89.68985 | 36.60276 | 19.16416 | 2.41865 | 4.01472 | 11.89531 |
|       Grove2       | 2.8202102  | 51.15918 | 16.57194 | 9.74023  | 1.02029 | 1.90721 | 9.63943  |
|--------------------|------------|----------|----------|----------|---------|---------|----------|

Average AE across dataset  5.762406587600708

|--------------------|------------|----------|----------|----------|---------|---------|---------|
| Middlebury dataset | Average EE |   R0.1   |   R0.5   |   R2.0   |   A50   |   A75   |   A95   |
|--------------------|------------|----------|----------|----------|---------|---------|---------|
|       Urban2       | 0.4468546  | 52.33333 | 13.95117 | 5.46257  | 0.10621 | 0.22596 | 2.41285 |
|    RubberWhale     | 0.17579743 | 22.6461  | 8.28318  | 1.67153  | 0.04558 | 0.08756 | 0.93647 |
|       Grove3       | 0.7476733  | 57.49056 | 27.26367 | 10.25618 |  0.1425 | 0.58952 | 4.59474 |
|     Dimetrodon     | 0.22215752 | 65.49254 | 10.5917  |  0.0139  |  0.1591 | 0.30538 | 0.65365 |
|     Hydrangea      | 0.18776187 | 34.90874 | 8.29476  | 1.08544  | 0.06212 | 0.15898 |  0.7348 |
|       Urban3       | 1.1303402  | 60.97624 | 30.95638 | 16.25879 | 0.16027 | 1.00564 | 5.58377 |
|       Venus        | 0.47675982 | 86.9906  | 16.8985  | 4.84712  | 0.21473 | 0.33024 | 1.89971 |
|       Grove2       | 0.18370628 | 31.67155 | 6.13281  | 1.70605  | 0.06558 | 0.13166 | 0.62501 |
|--------------------|------------|----------|----------|----------|---------|---------|---------|

Average EE across dataset  0.44638137705624104


### TEST CASE ANALOG 6 (Original parameters | increase min width)


|-------|---------------|-----------|------------|------------|----------|----------|
| alpha | pyramid scale | min width | outer iter | inner iter | sor iter | RGB/Gray |
|-------|---------------|-----------|------------|------------|----------|----------|
| 0.011 |      0.75     |     30    |     7      |     1      |    30    |    0     |
|-------|---------------|-----------|------------|------------|----------|----------|

Finished Processing
Time Taken: 7.24 seconds for image of size (480, 640, 3)


|--------------------|------------|----------|----------|----------|---------|---------|----------|
| Middlebury dataset | Average AE |   R1.0   |   R3.0   |   R5.0   |   A50   |   A75   |   A95    |
|--------------------|------------|----------|----------|----------|---------|---------|----------|
|       Urban2       | 2.7882957  | 41.16634 | 16.96712 | 9.84505  | 0.63827 | 2.05369 | 10.42709 |
|    RubberWhale     |  4.588147  |  59.926  | 19.78338 | 12.91071 | 1.23035 | 2.33655 | 18.51764 |
|       Grove3       |  6.123547  | 60.6237  | 29.28288 | 20.39811 | 1.38804 | 3.77142 | 25.84034 |
|     Dimetrodon     |  3.556438  | 79.54406 | 44.42359 | 23.7295  | 2.60639 | 4.84857 |  9.7973  |
|     Hydrangea      | 2.3159864  | 29.29073 | 17.81146 | 11.78299 | 0.60361 | 1.59563 | 10.48321 |
|       Urban3       |  7.503974  | 31.07129 | 20.25065 | 19.0765  | 0.52039 | 1.42038 | 50.84129 |
|       Venus        |  7.33535   | 89.05952 | 40.1604  | 18.52193 | 2.43039 | 3.77601 | 13.15695 |
|       Grove2       | 2.3947678  | 47.0957  | 10.45312 | 6.87174  | 0.94409 | 1.58868 | 7.97129  |
|--------------------|------------|----------|----------|----------|---------|---------|----------|

Average AE across dataset  4.575813263654709

|--------------------|------------|----------|----------|---------|---------|---------|---------|
| Middlebury dataset | Average EE |   R0.1   |   R0.5   |   R2.0  |   A50   |   A75   |   A95   |
|--------------------|------------|----------|----------|---------|---------|---------|---------|
|       Urban2       | 0.35638303 | 40.93327 | 9.56999  | 3.71842 |  0.0821 | 0.16599 | 1.21302 |
|    RubberWhale     | 0.13687348 |  19.495  | 5.04462  | 1.34996 | 0.04285 | 0.07738 | 0.50612 |
|       Grove3       | 0.66993964 | 56.1569  | 23.3916  | 8.62793 | 0.12516 | 0.44395 | 4.22095 |
|     Dimetrodon     | 0.19025308 | 61.90251 |  7.914   | 0.00834 | 0.13091 | 0.24685 | 0.58841 |
|     Hydrangea      | 0.1825642  | 30.79986 | 8.67074  | 1.01695 | 0.05039 | 0.16833 | 0.73728 |
|       Urban3       | 0.8203249  | 54.88444 | 27.74772 | 8.67806 | 0.12292 | 0.77073 | 4.36792 |
|       Venus        | 0.43893436 | 88.01441 | 13.94298 |  4.4411 | 0.21332 |  0.3351 | 1.63476 |
|       Grove2       | 0.16281322 | 27.75033 | 5.36947  | 1.41992 | 0.06622 | 0.10826 | 0.55855 |
|--------------------|------------|----------|----------|---------|---------|---------|---------|

Average EE across dataset  0.36976073682308197
